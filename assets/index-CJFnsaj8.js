import{c as Te,r as f,V as he,T as Ue,u as ve,j as d,B as $e,D as qe,M as Le,C as Ve,a as Je,b as Ze,d as Be}from"./three-BeVieSUO.js";import{a as p}from"./motion-CKc6RYma.js";import"./vendor-BtP0CW_r.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))o(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const s of i.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&o(s)}).observe(document,{childList:!0,subtree:!0});function n(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerPolicy&&(i.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?i.credentials="include":r.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function o(r){if(r.ep)return;r.ep=!0;const i=n(r);fetch(r.href,i)}})();function ze(e){var t,n,o="";if(typeof e=="string"||typeof e=="number")o+=e;else if(typeof e=="object")if(Array.isArray(e)){var r=e.length;for(t=0;t<r;t++)e[t]&&(n=ze(e[t]))&&(o&&(o+=" "),o+=n)}else for(n in e)e[n]&&(o&&(o+=" "),o+=n);return o}function _e(){for(var e,t,n=0,o="",r=arguments.length;n<r;n++)(e=arguments[n])&&(t=ze(e))&&(o&&(o+=" "),o+=t);return o}var Oe=Symbol.for("immer-nothing"),ye=Symbol.for("immer-draftable"),b=Symbol.for("immer-state");function S(e,...t){throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var E=Object.getPrototypeOf;function T(e){return!!e&&!!e[b]}function D(e){var t;return e?we(e)||Array.isArray(e)||!!e[ye]||!!((t=e.constructor)!=null&&t[ye])||Y(e)||Q(e):!1}var Xe=Object.prototype.constructor.toString();function we(e){if(!e||typeof e!="object")return!1;const t=E(e);if(t===null)return!0;const n=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;return n===Object?!0:typeof n=="function"&&Function.toString.call(n)===Xe}function B(e,t){K(e)===0?Reflect.ownKeys(e).forEach(n=>{t(n,e[n],e)}):e.forEach((n,o)=>t(o,n,e))}function K(e){const t=e[b];return t?t.type_:Array.isArray(e)?1:Y(e)?2:Q(e)?3:0}function oe(e,t){return K(e)===2?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function Ae(e,t,n){const o=K(e);o===2?e.set(t,n):o===3?e.add(n):e[t]=n}function We(e,t){return e===t?e!==0||1/e===1/t:e!==e&&t!==t}function Y(e){return e instanceof Map}function Q(e){return e instanceof Set}function k(e){return e.copy_||e.base_}function re(e,t){if(Y(e))return new Map(e);if(Q(e))return new Set(e);if(Array.isArray(e))return Array.prototype.slice.call(e);const n=we(e);if(t===!0||t==="class_only"&&!n){const o=Object.getOwnPropertyDescriptors(e);delete o[b];let r=Reflect.ownKeys(o);for(let i=0;i<r.length;i++){const s=r[i],a=o[s];a.writable===!1&&(a.writable=!0,a.configurable=!0),(a.get||a.set)&&(o[s]={configurable:!0,writable:!0,enumerable:a.enumerable,value:e[s]})}return Object.create(E(e),o)}else{const o=E(e);if(o!==null&&n)return{...e};const r=Object.create(o);return Object.assign(r,e)}}function le(e,t=!1){return G(e)||T(e)||!D(e)||(K(e)>1&&(e.set=e.add=e.clear=e.delete=Ke),Object.freeze(e),t&&Object.entries(e).forEach(([n,o])=>le(o,!0))),e}function Ke(){S(2)}function G(e){return Object.isFrozen(e)}var Ye={};function F(e){const t=Ye[e];return t||S(0,e),t}var L;function Ce(){return L}function Qe(e,t){return{drafts_:[],parent_:e,immer_:t,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function be(e,t){t&&(F("Patches"),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function ie(e){ae(e),e.drafts_.forEach(Ge),e.drafts_=null}function ae(e){e===L&&(L=e.parent_)}function xe(e){return L=Qe(L,e)}function Ge(e){const t=e[b];t.type_===0||t.type_===1?t.revoke_():t.revoked_=!0}function Ie(e,t){t.unfinalizedDrafts_=t.drafts_.length;const n=t.drafts_[0];return e!==void 0&&e!==n?(n[b].modified_&&(ie(t),S(4)),D(e)&&(e=X(t,e),t.parent_||W(t,e)),t.patches_&&F("Patches").generateReplacementPatches_(n[b].base_,e,t.patches_,t.inversePatches_)):e=X(t,n,[]),ie(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==Oe?e:void 0}function X(e,t,n){if(G(t))return t;const o=t[b];if(!o)return B(t,(r,i)=>Se(e,o,t,r,i,n)),t;if(o.scope_!==e)return t;if(!o.modified_)return W(e,o.base_,!0),o.base_;if(!o.finalized_){o.finalized_=!0,o.scope_.unfinalizedDrafts_--;const r=o.copy_;let i=r,s=!1;o.type_===3&&(i=new Set(r),r.clear(),s=!0),B(i,(a,c)=>Se(e,o,r,a,c,n,s)),W(e,r,!1),n&&e.patches_&&F("Patches").generatePatches_(o,n,e.patches_,e.inversePatches_)}return o.copy_}function Se(e,t,n,o,r,i,s){if(T(r)){const a=i&&t&&t.type_!==3&&!oe(t.assigned_,o)?i.concat(o):void 0,c=X(e,r,a);if(Ae(n,o,c),T(c))e.canAutoFreeze_=!1;else return}else s&&n.add(r);if(D(r)&&!G(r)){if(!e.immer_.autoFreeze_&&e.unfinalizedDrafts_<1)return;X(e,r),(!t||!t.scope_.parent_)&&typeof o!="symbol"&&Object.prototype.propertyIsEnumerable.call(n,o)&&W(e,r)}}function W(e,t,n=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&le(t,n)}function He(e,t){const n=Array.isArray(e),o={type_:n?1:0,scope_:t?t.scope_:Ce(),modified_:!1,finalized_:!1,assigned_:{},parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1};let r=o,i=ue;n&&(r=[o],i=V);const{revoke:s,proxy:a}=Proxy.revocable(r,i);return o.draft_=a,o.revoke_=s,a}var ue={get(e,t){if(t===b)return e;const n=k(e);if(!oe(n,t))return et(e,n,t);const o=n[t];return e.finalized_||!D(o)?o:o===ee(e.base_,t)?(te(e),e.copy_[t]=ce(o,e)):o},has(e,t){return t in k(e)},ownKeys(e){return Reflect.ownKeys(k(e))},set(e,t,n){const o=Ne(k(e),t);if(o!=null&&o.set)return o.set.call(e.draft_,n),!0;if(!e.modified_){const r=ee(k(e),t),i=r==null?void 0:r[b];if(i&&i.base_===n)return e.copy_[t]=n,e.assigned_[t]=!1,!0;if(We(n,r)&&(n!==void 0||oe(e.base_,t)))return!0;te(e),se(e)}return e.copy_[t]===n&&(n!==void 0||t in e.copy_)||Number.isNaN(n)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=n,e.assigned_[t]=!0),!0},deleteProperty(e,t){return ee(e.base_,t)!==void 0||t in e.base_?(e.assigned_[t]=!1,te(e),se(e)):delete e.assigned_[t],e.copy_&&delete e.copy_[t],!0},getOwnPropertyDescriptor(e,t){const n=k(e),o=Reflect.getOwnPropertyDescriptor(n,t);return o&&{writable:!0,configurable:e.type_!==1||t!=="length",enumerable:o.enumerable,value:n[t]}},defineProperty(){S(11)},getPrototypeOf(e){return E(e.base_)},setPrototypeOf(){S(12)}},V={};B(ue,(e,t)=>{V[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}});V.deleteProperty=function(e,t){return V.set.call(this,e,t,void 0)};V.set=function(e,t,n){return ue.set.call(this,e[0],t,n,e[0])};function ee(e,t){const n=e[b];return(n?k(n):e)[t]}function et(e,t,n){var r;const o=Ne(t,n);return o?"value"in o?o.value:(r=o.get)==null?void 0:r.call(e.draft_):void 0}function Ne(e,t){if(!(t in e))return;let n=E(e);for(;n;){const o=Object.getOwnPropertyDescriptor(n,t);if(o)return o;n=E(n)}}function se(e){e.modified_||(e.modified_=!0,e.parent_&&se(e.parent_))}function te(e){e.copy_||(e.copy_=re(e.base_,e.scope_.immer_.useStrictShallowCopy_))}var tt=class{constructor(e){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(t,n,o)=>{if(typeof t=="function"&&typeof n!="function"){const i=n;n=t;const s=this;return function(c=i,...M){return s.produce(c,C=>n.call(this,C,...M))}}typeof n!="function"&&S(6),o!==void 0&&typeof o!="function"&&S(7);let r;if(D(t)){const i=xe(this),s=ce(t,void 0);let a=!0;try{r=n(s),a=!1}finally{a?ie(i):ae(i)}return be(i,o),Ie(r,i)}else if(!t||typeof t!="object"){if(r=n(t),r===void 0&&(r=t),r===Oe&&(r=void 0),this.autoFreeze_&&le(r,!0),o){const i=[],s=[];F("Patches").generateReplacementPatches_(t,r,i,s),o(i,s)}return r}else S(1,t)},this.produceWithPatches=(t,n)=>{if(typeof t=="function")return(s,...a)=>this.produceWithPatches(s,c=>t(c,...a));let o,r;return[this.produce(t,n,(s,a)=>{o=s,r=a}),o,r]},typeof(e==null?void 0:e.autoFreeze)=="boolean"&&this.setAutoFreeze(e.autoFreeze),typeof(e==null?void 0:e.useStrictShallowCopy)=="boolean"&&this.setUseStrictShallowCopy(e.useStrictShallowCopy)}createDraft(e){D(e)||S(8),T(e)&&(e=nt(e));const t=xe(this),n=ce(e,void 0);return n[b].isManual_=!0,ae(t),n}finishDraft(e,t){const n=e&&e[b];(!n||!n.isManual_)&&S(9);const{scope_:o}=n;return be(o,t),Ie(void 0,o)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}applyPatches(e,t){let n;for(n=t.length-1;n>=0;n--){const r=t[n];if(r.path.length===0&&r.op==="replace"){e=r.value;break}}n>-1&&(t=t.slice(n+1));const o=F("Patches").applyPatches_;return T(e)?o(e,t):this.produce(e,r=>o(r,t))}};function ce(e,t){const n=Y(e)?F("MapSet").proxyMap_(e,t):Q(e)?F("MapSet").proxySet_(e,t):He(e,t);return(t?t.scope_:Ce()).drafts_.push(n),n}function nt(e){return T(e)||S(10,e),ke(e)}function ke(e){if(!D(e)||G(e))return e;const t=e[b];let n;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,n=re(e,t.scope_.immer_.useStrictShallowCopy_)}else n=re(e,!0);return B(n,(o,r)=>{Ae(n,o,ke(r))}),t&&(t.finalized_=!1),n}var x=new tt,ot=x.produce;x.produceWithPatches.bind(x);x.setAutoFreeze.bind(x);x.setUseStrictShallowCopy.bind(x);x.applyPatches.bind(x);x.createDraft.bind(x);x.finishDraft.bind(x);const rt=e=>(t,n,o)=>(o.setState=(r,i,...s)=>{const a=typeof r=="function"?ot(r):r;return t(a,i,...s)},e(o.setState,n,o)),it=rt;/**
 * @license
 * SPDX-License-Identifier: Apache-2.0
*/const R=Te(it(e=>({didInit:!1,images:null,layout:"sphere",layouts:null,nodePositions:null,highlightNodes:null,isSidebarOpen:!1,targetImage:null,resetCam:!1,cameraCurrentZ:0}))),Pe=[{id:"Img_bea_01.png",description:"Uma bela vista da categoria 'bea', item número 1. Detalhes incríveis e cores vibrantes."},{id:"Img_bea_02.png",description:"Explorando o item 2 da série 'bea'. Uma composição verdadeiramente inspiradora."},{id:"Img_bea_03.png",description:"A terceira imagem da coleção 'bea', capturando um momento único e especial."},{id:"Img_bea_04.png",description:"Item 'bea' de número 4. A luz e sombra criam uma atmosfera mágica aqui."},{id:"Img_bea_05.png",description:"Descobrindo a beleza no quinto exemplar 'bea'. Uma cena para ser admirada."},{id:"Img_bea_06.png",description:"Sexta representação 'bea'. Texturas ricas e uma perspectiva envolvente."},{id:"Img_bea_07.png",description:"A arte em 'bea', número 7. Cada detalhe conta uma história diferente."},{id:"Img_bea_08.png",description:"Oitava maravilha da série 'bea'. Um convite à contemplação e imaginação."},{id:"Img_bea_09.png",description:"Quase no fim da linha 'bea', imagem 9. Simplesmente espetacular e memorável."},{id:"Img_bea_10.png",description:"Fechando a categoria 'bea' com a décima imagem. Uma obra-prima visual."},{id:"Img_skate_01.png",description:"Radical! A primeira imagem de 'skate'. Manobras e estilo em cada pixel."},{id:"Img_skate_02.png",description:"Item 2 da série 'skate'. A cultura urbana capturada em um instante."},{id:"Img_skate_03.png",description:"A terceira imagem da coleção 'skate', mostrando a energia das ruas."},{id:"Img_skate_04.png",description:"Adrenalina pura no item 'skate' de número 4. Liberdade sobre rodas."},{id:"Img_skate_05.png",description:"O quinto exemplar 'skate'. A arte do equilíbrio e da criatividade."},{id:"Img_skate_06.png",description:"Sexta foto 'skate'. Um olhar sobre a paixão pelo esporte e pela vida."},{id:"Img_skate_07.png",description:"A vibe 'skate' no número 7. Expressão e movimento em harmonia."},{id:"Img_skate_08.png",description:"Oitava imagem da série 'skate'. Superando limites e desafiando a gravidade."},{id:"Img_skate_09.png",description:"Chegando ao fim da sessão 'skate', imagem 9. Atitude e originalidade."},{id:"Img_skate_10.png",description:"Encerrando a categoria 'skate' com a imagem 10. Puro talento e dedicação."},{id:"Img_head_01.png",description:"Foco no detalhe: primeira imagem 'head'. Expressões que falam por si."},{id:"Img_head_02.png",description:"Item 2 da série 'head'. Um retrato da individualidade e estilo."},{id:"Img_head_03.png",description:"A terceira imagem 'head', capturando a essência e a personalidade."},{id:"Img_head_04.png",description:"Olhares e pensamentos no item 'head' de número 4. Profundidade e emoção."},{id:"Img_head_05.png",description:"O quinto exemplar 'head'. A beleza está nos detalhes únicos."},{id:"Img_head_06.png",description:"Sexta foto 'head'. Uma janela para a alma e suas histórias."},{id:"Img_head_07.png",description:"A perspectiva 'head' no número 7. Cada rosto, um universo."},{id:"Img_head_08.png",description:"Oitava imagem da série 'head'. Força, caráter e autenticidade."},{id:"Img_head_09.png",description:"Retrato finalizando a série 'head', imagem 9. Singularidade em destaque."},{id:"Img_head_10.png",description:"Concluindo 'head' com a décima imagem. A história por trás de cada olhar."},{id:"Img_tenis_01.png",description:"Estilo nos pés: imagem 1 de 'tenis'. Design e conforto se encontram."},{id:"Img_tenis_02.png",description:"Item 2 da série 'tenis'. Mais que um calçado, uma declaração."},{id:"Img_tenis_03.png",description:"A terceira imagem 'tenis', mostrando inovação e atitude."},{id:"Img_tenis_04.png",description:"Performance e moda no item 'tenis' número 4. Pronto para qualquer jornada."},{id:"Img_tenis_05.png",description:"O quinto exemplar 'tenis'. Detalhes que fazem toda a diferença."},{id:"Img_tenis_06.png",description:"Sexta foto 'tenis'. A combinação perfeita de funcionalidade e estética."},{id:"Img_tenis_07.png",description:"A tendência 'tenis' no número 7. Conectando você ao seu caminho."},{id:"Img_tenis_08.png",description:"Oitava imagem da série 'tenis'. Durabilidade e um visual impecável."},{id:"Img_tenis_09.png",description:"Quase lá na coleção 'tenis', imagem 9. Para quem não abre mão de estilo."},{id:"Img_tenis_10.png",description:"Fechando 'tenis' com a décima imagem. A escolha certa para seus passos."},{id:"Img_bag_01.png",description:"Acessório essencial: primeira imagem 'bag'. Praticidade e elegância."},{id:"Img_bag_02.png",description:"Item 2 da série 'bag'. Leve tudo o que precisa com muito estilo."},{id:"Img_bag_03.png",description:"A terceira imagem 'bag', design inteligente para o dia a dia."},{id:"Img_bag_04.png",description:"Funcionalidade e charme no item 'bag' número 4. Sua companheira ideal."},{id:"Img_bag_05.png",description:"O quinto exemplar 'bag'. Detalhes que refletem sua personalidade."},{id:"Img_bag_06.png",description:"Sexta foto 'bag'. Organização e um toque de sofisticação."},{id:"Img_bag_07.png",description:"O look completo com 'bag' número 7. Versatilidade para todas as ocasiões."},{id:"Img_bag_08.png",description:"Oitava imagem da série 'bag'. Qualidade e design que impressionam."},{id:"Img_bag_09.png",description:"Finalizando a coleção 'bag', imagem 9. O detalhe que faltava."},{id:"Img_bag_10.png",description:"Concluindo 'bag' com a décima imagem. Perfeita para suas aventuras."},{id:"Img_food_01.png",description:"Delícia à vista: primeira imagem 'food'. Sabores que encantam."},{id:"Img_food_02.png",description:"Item 2 da série 'food'. Uma experiência gastronômica inesquecível."},{id:"Img_food_03.png",description:"A terceira imagem 'food', arte culinária que inspira."},{id:"Img_food_04.png",description:"Ingredientes frescos e paixão no item 'food' número 4. Para todos os paladares."},{id:"Img_food_05.png",description:"O quinto exemplar 'food'. Uma verdadeira festa de cores e sabores."},{id:"Img_food_06.png",description:"Sexta foto 'food'. Tradição e inovação em cada prato."},{id:"Img_food_07.png",description:"O prazer de comer bem com 'food' número 7. Momentos deliciosos."},{id:"Img_food_08.png",description:"Oitava imagem da série 'food'. Da cozinha para sua mesa, com carinho."},{id:"Img_food_09.png",description:"Quase na sobremesa da coleção 'food', imagem 9. Uma tentação irresistível."},{id:"Img_food_10.png",description:"Fechando o cardápio 'food' com a décima imagem. Bom apetite e volte sempre!"}];/**
 * @license
 * SPDX-License-Identifier: Apache-2.0
*/const de=R.getState,J=R.setState,at=async()=>{if(console.log("[actions.js] init() called"),de().didInit){console.log("[actions.js] init() already run, returning.");return}J(i=>{i.didInit=!0}),console.log("[actions.js] Fetching layout data...");const[e,t]=await Promise.all(["sphere","umap-grid"].map(i=>fetch(`/thinking-space/${i}.json`).then(s=>s.json())));console.log("[actions.js] Layout data fetched:",{sphereLayoutData:e,umapGridLayoutData:t}),console.log("[actions.js] Imported localMeta:",Pe);const n=Pe,o=Object.values(e),r=Object.values(t).map(([i,s])=>[i,s/(16/9)+.25]);J(i=>{i.images=n,i.rawLayoutPositions={sphere:o,grid:r},i.nodePositions=Object.fromEntries(n.map(({id:s})=>[s,[.5,.5,.5]])),i.layouts={},console.log("[actions.js] State after setting images and layouts:",JSON.parse(JSON.stringify(i)))}),st("sphere"),console.log("[actions.js] init() finished")},st=e=>{console.log(`[actions.js] setLayout called with layout: ${e}`),J(t=>{t.layout=e;const n=t.rawLayoutPositions[e];if(!n){console.error(`Layout positions for "${e}" not found in state.rawLayoutPositions.`),t.nodePositions=Object.fromEntries(t.images.map(({id:r})=>[r,[.5,.5,.5]]));return}const o={};t.images.forEach((r,i)=>{i<n.length?o[r.id]=n[i]:o[r.id]=n[n.length-1]||[.5,.5,.5]}),t.nodePositions=o,console.log(`[actions.js] State after setLayout(${e}):`,JSON.parse(JSON.stringify(t)))})},Re=async e=>{console.log(`[actions.js] setTargetImage called with: ${e}`),e===de().targetImage&&(console.log("[actions.js] Unsetting targetImage."),e=null),J(t=>{t.targetImage=e,t.highlightNodes=null,e===null&&(t.resetCam=!0,console.log("[actions.js] resetCam set to true."))}),console.log(`[actions.js] targetImage set to: ${de().targetImage}`)},ct=()=>{console.log("[actions.js] toggleSidebar called"),J(e=>{e.isSidebarOpen=!e.isSidebarOpen,console.log(`[actions.js] isSidebarOpen set to: ${e.isSidebarOpen}`)})};at();const dt=16/16,De=16,lt=De*dt,ut=({id:e,position:t,targetImage:n})=>{const o=`/thinking-space/assets/images/${e}`;console.log(`[PhotoNode.jsx] Attempting to load texture for ID ${e} from URL: ${o}`);const r=f.useRef(),i=f.useRef(),[s,a]=f.useState(null),c=f.useRef(new he(...t)),M=f.useRef(new he(...t));f.useEffect(()=>{new Ue().load(o,w=>{a(w),console.log(`[PhotoNode.jsx] Texture loaded successfully for ${e}`)},void 0,w=>{console.error(`[PhotoNode.jsx] Failed to load texture for ${e}:`,w),a(null)})},[o,e]),f.useEffect(()=>{c.current.set(...t)},[t]);const C=n===e,N=!n||C?1:.2;return ve((O,w)=>{i.current&&(M.current.lerp(c.current,w*2),i.current.position.copy(M.current)),r.current&&r.current.material&&(r.current.material.opacity=Le.lerp(r.current.material.opacity,N,w*5))}),console.log(`[PhotoNode.jsx] ID: ${e}, targetImage: ${n}, isActive: ${C}, nodeOpacity: ${N}`),d.jsx("group",{ref:i,onClick:O=>{O.stopPropagation(),Re(e),console.log(`[PhotoNode.jsx] Clicked. Setting targetImage to: ${e}`)},children:d.jsx($e,{children:d.jsxs("mesh",{ref:r,scale:[lt,De,1],children:[d.jsx("planeGeometry",{}),d.jsx("meshStandardMaterial",{map:s,color:s?"white":"red",transparent:!0,opacity:N,side:qe})]})})})};function mt(){console.log("[PhotoViz.jsx] SceneContent rendering");const{images:e,nodePositions:t,layout:n,highlightNodes:o,targetImage:r,resetCam:i}=R(l=>(console.log("[PhotoViz.jsx] SceneContent useStore called, current state:",JSON.parse(JSON.stringify(l))),{images:l.images,nodePositions:l.nodePositions,layout:l.layout,highlightNodes:l.highlightNodes,targetImage:l.targetImage,resetCam:l.resetCam}));console.log("[PhotoViz.jsx] SceneContent values from useStore:",{imagesLength:e==null?void 0:e.length,nodePositionsKeys:t?Object.keys(t).length:0,layout:n,highlightNodes:o,targetImage:r,resetCam:i});const{camera:s}=Je(),a=f.useRef(),c=f.useRef(),[M,C]=f.useState(!1),N=f.useRef(null),O=f.useRef(0),w=25,Fe=.1,me=.5,ge=()=>{clearTimeout(N.current)},Me=()=>{C(!1),clearTimeout(N.current),O.current=0},Ee=()=>{ge()};return f.useEffect(()=>{if(r&&t&&n&&s&&c.current&&a.current){C(!1),clearTimeout(N.current),O.current=0;const l=t[r];if(!l){console.warn(`No node position found for targetImage: ${r}`);return}const g=(l[0]-.5)*600,m=(l[1]-.5)*600,z=((l[2]||0)-.5)*600,I=a.current.rotation.y,_=a.current.position.z,y={x:g*Math.cos(I)-z*Math.sin(I),y:m,z:g*Math.sin(I)+z*Math.cos(I)+_},P=.8,A="easeInOut",u=c.current.target.clone(),U=[p(u.x,y.x,{duration:P,ease:A,onUpdate:h=>{c.current&&(c.current.target.x=h)}}),p(u.y,y.y,{duration:P,ease:A,onUpdate:h=>{c.current&&(c.current.target.y=h)}}),p(u.z,y.z,{duration:P,ease:A,onUpdate:h=>{c.current&&(c.current.target.z=h)}})],j=s.position.clone().sub(c.current.target);j.lengthSq()===0&&j.set(0,0,1),j.normalize().multiplyScalar(w);const v={x:y.x+j.x,y:y.y+j.y,z:y.z+j.z},$=[p(s.position.x,v.x,{duration:P,ease:A,onUpdate:h=>s.position.x=h}),p(s.position.y,v.y,{duration:P,ease:A,onUpdate:h=>s.position.y=h}),p(s.position.z,v.z,{duration:P,ease:A,onUpdate:h=>s.position.z=h})],H=[...U,...$];Promise.all(H.map(h=>h.finished)).then(()=>{c.current&&s&&(s.position.set(v.x,v.y,v.z),c.current.target.set(y.x,y.y,y.z))})}else r||ge()},[r,t,n,s]),f.useEffect(()=>{const l=c.current,g=.8,m="easeInOut";if(l&&s&&i){let z=300;const I=n==="grid"?150:0;if(t&&e&&e.length>0){const u=Object.values(t);if(u.length>0){let U=1/0,j=-1/0,v=1/0,$=-1/0;u.forEach(Z=>{const q=(Z[0]-.5)*600,pe=(Z[1]-.5)*600;U=Math.min(U,q),j=Math.max(j,q),v=Math.min(v,pe),$=Math.max($,pe)});const H=j-U,h=$-v,fe=Math.max(H,h,e.length===1?32:0);if(fe>0){const Z=s.fov*Math.PI/180;let q=fe/.8/2/Math.tan(Z/2);q*=1.15,z=Math.max(150,Math.min(q,195))}else z=e.length===1?150:195}}const _=[0,0,I],y=[0,0,I+z],P=l.target.clone(),A=[p(s.position.x,y[0],{duration:g,ease:m,onUpdate:u=>s.position.x=u}),p(s.position.y,y[1],{duration:g,ease:m,onUpdate:u=>s.position.y=u}),p(s.position.z,y[2],{duration:g,ease:m,onUpdate:u=>s.position.z=u}),p(P.x,_[0],{duration:g,ease:m,onUpdate:u=>{c.current&&(c.current.target.x=u)}}),p(P.y,_[1],{duration:g,ease:m,onUpdate:u=>{c.current&&(c.current.target.y=u)}}),p(P.z,_[2],{duration:g,ease:m,onUpdate:u=>{c.current&&(c.current.target.z=u)}})];Promise.all(A.map(u=>u.finished)).then(()=>{c.current&&s&&(s.position.set(...y),c.current.target.set(..._))})}if(a.current&&(n||i)){const I="easeInOut";p(a.current.position.z,n==="grid"?150:0,{duration:.8,ease:I,onUpdate:_=>a.current.position.z=_}),i&&(p(a.current.rotation.x,0,{duration:.8,ease:I,onUpdate:_=>a.current.rotation.x=_}),p(a.current.rotation.y,0,{duration:.8,ease:I,onUpdate:_=>a.current.rotation.y=_}),p(a.current.rotation.z,0,{duration:.8,ease:I,onUpdate:_=>a.current.rotation.z=_}))}i&&R.setState(z=>{z.resetCam=!1})},[n,s,i,e,t]),ve((l,g)=>{R.setState({cameraCurrentZ:s.position.z});let m=O.current;M?m+=(Fe-m)*me*g:m+=(0-m)*me*g,O.current=m,a.current&&Math.abs(m)>1e-4&&n!=="grid"&&!r&&(a.current.rotation.y+=m*g),c.current&&c.current.update()}),console.log("[PhotoViz.jsx] SceneContent returning JSX"),d.jsxs(d.Fragment,{children:[d.jsx("ambientLight",{intensity:2.3}),d.jsx(Ze,{ref:c,onStart:Me,onEnd:Ee,minDistance:20,maxDistance:195,noPan:!0}),d.jsx("group",{ref:a,children:e==null?void 0:e.map(l=>{const g=t==null?void 0:t[l.id];if(!g)return console.warn(`[PhotoViz.jsx] No position found for image ID: ${l.id} in nodePositions. Skipping render.`),null;const m=[(g[0]-.5)*600,(g[1]-.5)*600,((g[2]||0)-.5)*600];return console.log(`[PhotoViz.jsx] Rendering PhotoNode for ${l.id} with scaledPosition:`,m,`targetImage: ${r}`),d.jsx(ut,{id:l.id,position:m,targetImage:r},l.id)})})]})}function gt(){return console.log("[PhotoViz.jsx] PhotoViz rendering"),d.jsx(Ve,{camera:{position:[0,0,195],near:.1,far:1e4},onPointerMissed:()=>Re(null),children:d.jsx(mt,{})})}function ft({title:e,titleId:t,...n},o){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:o,"aria-labelledby":t},n),e?f.createElement("title",{id:t},e):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18 18 6M6 6l12 12"}))}const pt=f.forwardRef(ft),ne=(e,t=7)=>{if(!e)return"";const n=e.split(" ");return n.length<=t?e:n.slice(0,t).join(" ")+" ..."},ht=()=>{console.log("[Sidebar.jsx] Rendering Sidebar component");const{images:e,targetImage:t,isSidebarOpen:n,toggleSidebar:o,setTargetImage:r}=R(a=>(console.log("[Sidebar.jsx] useStore called, current state:",JSON.parse(JSON.stringify(a))),{images:a.images,targetImage:a.targetImage,isSidebarOpen:a.isSidebarOpen,toggleSidebar:a.toggleSidebar,setTargetImage:a.setTargetImage}));console.log("[Sidebar.jsx] Values from useStore:",{imagesLength:e==null?void 0:e.length,targetImage:t,isSidebarOpen:n});const i=e?e.find(a=>a.id===t):null;console.log("[Sidebar.jsx] selectedImage:",i?i.id:null);const s=e?[...e].sort((a,c)=>a.id.localeCompare(c.id)):[];return console.log("[Sidebar.jsx] sortedImages length:",s.length),console.log("[Sidebar.jsx] Returning JSX"),d.jsxs("div",{className:`fixed top-0 right-0 h-full bg-gray-800 bg-opacity-90 text-white p-4 transition-transform duration-300 ease-in-out transform ${n?"translate-x-0":"translate-x-full"} w-80 md:w-96 z-30 shadow-lg`,children:[d.jsx("button",{onClick:o,className:"absolute top-4 right-4 text-white hover:text-gray-300 transition-colors text-2xl z-40",children:d.jsx(pt,{className:"h-8 w-8"})}),i&&d.jsxs("div",{className:"mb-6 pt-8",children:[d.jsx("h2",{className:"text-2xl font-bold mb-3",children:"Selected Image"}),d.jsxs("div",{className:"bg-gray-700 p-3 rounded-lg shadow-md",children:[d.jsx("img",{src:`/thinking-space/assets/images/${i.id}`,alt:i.description,className:"w-full h-auto object-cover rounded-md mb-2 shadow-sm"}),d.jsx("p",{className:"text-sm text-gray-300 leading-relaxed",children:ne(i.description,3)})]})]}),d.jsxs("ul",{children:[s.map(a=>d.jsxs("li",{onClick:()=>r(a.id),className:`cursor-pointer p-2 hover:bg-gray-700 rounded-md transition-colors duration-150 flex items-center space-x-3 ${t===a.id?"bg-blue-500 bg-opacity-40":""}`,children:[d.jsx("img",{src:`/thinking-space/assets/images/${a.id}`,alt:ne(a.description,3),className:"w-16 h-16 object-cover rounded-sm shadow-sm"}),d.jsx("div",{children:d.jsx("p",{children:ne(a.description,3)})})]},a.id)),(!e||e.length===0)&&d.jsx("li",{children:"No images available."})]})]})};function _t(){var s;console.log("[App.jsx] Rendering App component");const{layout:e,isSidebarOpen:t,images:n,targetImage:o,cameraCurrentZ:r}=R(a=>(console.log("[App.jsx] useStore called, current state:",JSON.parse(JSON.stringify(a))),{layout:a.layout,isSidebarOpen:a.isSidebarOpen,images:a.images,targetImage:a.targetImage,cameraCurrentZ:a.cameraCurrentZ}));console.log("[App.jsx] Values from useStore:",{layout:e,isSidebarOpen:t,imagesLength:n==null?void 0:n.length,targetImage:o,cameraCurrentZ:r}),console.log("Current targetImage:",o);const i=o&&n?(s=n.find(a=>a.id===o))==null?void 0:s.description:null;return console.log("Current selectedImageDescription:",i),console.log("[App.jsx] Returning JSX"),d.jsxs("main",{children:[d.jsx(gt,{}),d.jsx(ht,{}),i&&d.jsx("div",{className:_e("description-panel",{visible:!!i}),children:d.jsx("p",{children:i})}),d.jsx("button",{onClick:ct,className:_e("sidebarButton iconButton",{active:t}),"aria-label":"Toggle photo list",title:"Toggle photo list",children:d.jsx("span",{className:"icon",children:"list"})}),d.jsxs("div",{style:{position:"fixed",bottom:"10px",left:"10px",backgroundColor:"rgba(0,0,0,0.5)",color:"white",padding:"5px 10px",borderRadius:"3px",fontSize:"12px",zIndex:1e4},children:["Camera Z: ",r.toFixed(2)]})]})}/**
 * @license
 * SPDX-License-Identifier: Apache-2.0
*/console.log("[main.tsx] Script start");console.log("[main.tsx] Rendering React app");const je=document.getElementById("root");je?Be.createRoot(je).render(d.jsx(_t,{})):console.error("[main.tsx] Root element not found");
//# sourceMappingURL=index-CJFnsaj8.js.map
