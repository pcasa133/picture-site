import{u as Re,R as De,r as m,V as P,T as Ee,a as be,j as c,B as Ne,D as Fe,M as X,C as Te,b as ke,c as $e,d as qe}from"./three-QvK4sKc3.js";import"./vendor-BtP0CW_r.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))n(o);new MutationObserver(o=>{for(const i of o)if(i.type==="childList")for(const s of i.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&n(s)}).observe(document,{childList:!0,subtree:!0});function r(o){const i={};return o.integrity&&(i.integrity=o.integrity),o.referrerPolicy&&(i.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?i.credentials="include":o.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(o){if(o.ep)return;o.ep=!0;const i=r(o);fetch(o.href,i)}})();function xe(e){var t,r,n="";if(typeof e=="string"||typeof e=="number")n+=e;else if(typeof e=="object")if(Array.isArray(e)){var o=e.length;for(t=0;t<o;t++)e[t]&&(r=xe(e[t]))&&(n&&(n+=" "),n+=r)}else for(r in e)e[r]&&(n&&(n+=" "),n+=r);return n}function q(){for(var e,t,r=0,n="",o=arguments.length;r<o;r++)(e=arguments[r])&&(t=xe(e))&&(n&&(n+=" "),n+=t);return n}const Le={},de=e=>{let t;const r=new Set,n=(p,l)=>{const S=typeof p=="function"?p(t):p;if(!Object.is(S,t)){const v=t;t=l??(typeof S!="object"||S===null)?S:Object.assign({},t,S),r.forEach(j=>j(t,v))}},o=()=>t,f={setState:n,getState:o,getInitialState:()=>I,subscribe:p=>(r.add(p),()=>r.delete(p)),destroy:()=>{(Le?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),r.clear()}},I=t=e(n,o,f);return f},Me=e=>e?de(e):de,Se={},{useDebugValue:Ue}=De,{useSyncExternalStoreWithSelector:Be}=Re;let le=!1;const Ve=e=>e;function We(e,t=Ve,r){(Se?"production":void 0)!=="production"&&r&&!le&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),le=!0);const n=Be(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,r);return Ue(n),n}const ue=e=>{(Se?"production":void 0)!=="production"&&typeof e!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const t=typeof e=="function"?Me(e):e,r=(n,o)=>We(t,n,o);return Object.assign(r,t),r},Ze=e=>e?ue(e):ue;var Ie=Symbol.for("immer-nothing"),me=Symbol.for("immer-draftable"),h=Symbol.for("immer-state");function x(e,...t){throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var D=Object.getPrototypeOf;function E(e){return!!e&&!!e[h]}function A(e){var t;return e?Pe(e)||Array.isArray(e)||!!e[me]||!!((t=e.constructor)!=null&&t[me])||V(e)||W(e):!1}var Je=Object.prototype.constructor.toString();function Pe(e){if(!e||typeof e!="object")return!1;const t=D(e);if(t===null)return!0;const r=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;return r===Object?!0:typeof r=="function"&&Function.toString.call(r)===Je}function L(e,t){B(e)===0?Reflect.ownKeys(e).forEach(r=>{t(r,e[r],e)}):e.forEach((r,n)=>t(n,r,e))}function B(e){const t=e[h];return t?t.type_:Array.isArray(e)?1:V(e)?2:W(e)?3:0}function H(e,t){return B(e)===2?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function ve(e,t,r){const n=B(e);n===2?e.set(t,r):n===3?e.add(r):e[t]=r}function Ge(e,t){return e===t?e!==0||1/e===1/t:e!==e&&t!==t}function V(e){return e instanceof Map}function W(e){return e instanceof Set}function w(e){return e.copy_||e.base_}function Q(e,t){if(V(e))return new Map(e);if(W(e))return new Set(e);if(Array.isArray(e))return Array.prototype.slice.call(e);const r=Pe(e);if(t===!0||t==="class_only"&&!r){const n=Object.getOwnPropertyDescriptors(e);delete n[h];let o=Reflect.ownKeys(n);for(let i=0;i<o.length;i++){const s=o[i],a=n[s];a.writable===!1&&(a.writable=!0,a.configurable=!0),(a.get||a.set)&&(n[s]={configurable:!0,writable:!0,enumerable:a.enumerable,value:e[s]})}return Object.create(D(e),n)}else{const n=D(e);if(n!==null&&r)return{...e};const o=Object.create(n);return Object.assign(o,e)}}function ie(e,t=!1){return Z(e)||E(e)||!A(e)||(B(e)>1&&(e.set=e.add=e.clear=e.delete=Ke),Object.freeze(e),t&&Object.entries(e).forEach(([r,n])=>ie(n,!0))),e}function Ke(){x(2)}function Z(e){return Object.isFrozen(e)}var Xe={};function z(e){const t=Xe[e];return t||x(0,e),t}var T;function je(){return T}function He(e,t){return{drafts_:[],parent_:e,immer_:t,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function ge(e,t){t&&(z("Patches"),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function Y(e){ee(e),e.drafts_.forEach(Qe),e.drafts_=null}function ee(e){e===T&&(T=e.parent_)}function fe(e){return T=He(T,e)}function Qe(e){const t=e[h];t.type_===0||t.type_===1?t.revoke_():t.revoked_=!0}function pe(e,t){t.unfinalizedDrafts_=t.drafts_.length;const r=t.drafts_[0];return e!==void 0&&e!==r?(r[h].modified_&&(Y(t),x(4)),A(e)&&(e=M(t,e),t.parent_||U(t,e)),t.patches_&&z("Patches").generateReplacementPatches_(r[h].base_,e,t.patches_,t.inversePatches_)):e=M(t,r,[]),Y(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==Ie?e:void 0}function M(e,t,r){if(Z(t))return t;const n=t[h];if(!n)return L(t,(o,i)=>_e(e,n,t,o,i,r)),t;if(n.scope_!==e)return t;if(!n.modified_)return U(e,n.base_,!0),n.base_;if(!n.finalized_){n.finalized_=!0,n.scope_.unfinalizedDrafts_--;const o=n.copy_;let i=o,s=!1;n.type_===3&&(i=new Set(o),o.clear(),s=!0),L(i,(a,f)=>_e(e,n,o,a,f,r,s)),U(e,o,!1),r&&e.patches_&&z("Patches").generatePatches_(n,r,e.patches_,e.inversePatches_)}return n.copy_}function _e(e,t,r,n,o,i,s){if(E(o)){const a=i&&t&&t.type_!==3&&!H(t.assigned_,n)?i.concat(n):void 0,f=M(e,o,a);if(ve(r,n,f),E(f))e.canAutoFreeze_=!1;else return}else s&&r.add(o);if(A(o)&&!Z(o)){if(!e.immer_.autoFreeze_&&e.unfinalizedDrafts_<1)return;M(e,o),(!t||!t.scope_.parent_)&&typeof n!="symbol"&&Object.prototype.propertyIsEnumerable.call(r,n)&&U(e,o)}}function U(e,t,r=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&ie(t,r)}function Ye(e,t){const r=Array.isArray(e),n={type_:r?1:0,scope_:t?t.scope_:je(),modified_:!1,finalized_:!1,assigned_:{},parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1};let o=n,i=se;r&&(o=[n],i=k);const{revoke:s,proxy:a}=Proxy.revocable(o,i);return n.draft_=a,n.revoke_=s,a}var se={get(e,t){if(t===h)return e;const r=w(e);if(!H(r,t))return et(e,r,t);const n=r[t];return e.finalized_||!A(n)?n:n===J(e.base_,t)?(G(e),e.copy_[t]=re(n,e)):n},has(e,t){return t in w(e)},ownKeys(e){return Reflect.ownKeys(w(e))},set(e,t,r){const n=we(w(e),t);if(n!=null&&n.set)return n.set.call(e.draft_,r),!0;if(!e.modified_){const o=J(w(e),t),i=o==null?void 0:o[h];if(i&&i.base_===r)return e.copy_[t]=r,e.assigned_[t]=!1,!0;if(Ge(r,o)&&(r!==void 0||H(e.base_,t)))return!0;G(e),te(e)}return e.copy_[t]===r&&(r!==void 0||t in e.copy_)||Number.isNaN(r)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=r,e.assigned_[t]=!0),!0},deleteProperty(e,t){return J(e.base_,t)!==void 0||t in e.base_?(e.assigned_[t]=!1,G(e),te(e)):delete e.assigned_[t],e.copy_&&delete e.copy_[t],!0},getOwnPropertyDescriptor(e,t){const r=w(e),n=Reflect.getOwnPropertyDescriptor(r,t);return n&&{writable:!0,configurable:e.type_!==1||t!=="length",enumerable:n.enumerable,value:r[t]}},defineProperty(){x(11)},getPrototypeOf(e){return D(e.base_)},setPrototypeOf(){x(12)}},k={};L(se,(e,t)=>{k[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}});k.deleteProperty=function(e,t){return k.set.call(this,e,t,void 0)};k.set=function(e,t,r){return se.set.call(this,e[0],t,r,e[0])};function J(e,t){const r=e[h];return(r?w(r):e)[t]}function et(e,t,r){var o;const n=we(t,r);return n?"value"in n?n.value:(o=n.get)==null?void 0:o.call(e.draft_):void 0}function we(e,t){if(!(t in e))return;let r=D(e);for(;r;){const n=Object.getOwnPropertyDescriptor(r,t);if(n)return n;r=D(r)}}function te(e){e.modified_||(e.modified_=!0,e.parent_&&te(e.parent_))}function G(e){e.copy_||(e.copy_=Q(e.base_,e.scope_.immer_.useStrictShallowCopy_))}var tt=class{constructor(e){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(t,r,n)=>{if(typeof t=="function"&&typeof r!="function"){const i=r;r=t;const s=this;return function(f=i,...I){return s.produce(f,p=>r.call(this,p,...I))}}typeof r!="function"&&x(6),n!==void 0&&typeof n!="function"&&x(7);let o;if(A(t)){const i=fe(this),s=re(t,void 0);let a=!0;try{o=r(s),a=!1}finally{a?Y(i):ee(i)}return ge(i,n),pe(o,i)}else if(!t||typeof t!="object"){if(o=r(t),o===void 0&&(o=t),o===Ie&&(o=void 0),this.autoFreeze_&&ie(o,!0),n){const i=[],s=[];z("Patches").generateReplacementPatches_(t,o,i,s),n(i,s)}return o}else x(1,t)},this.produceWithPatches=(t,r)=>{if(typeof t=="function")return(s,...a)=>this.produceWithPatches(s,f=>t(f,...a));let n,o;return[this.produce(t,r,(s,a)=>{n=s,o=a}),n,o]},typeof(e==null?void 0:e.autoFreeze)=="boolean"&&this.setAutoFreeze(e.autoFreeze),typeof(e==null?void 0:e.useStrictShallowCopy)=="boolean"&&this.setUseStrictShallowCopy(e.useStrictShallowCopy)}createDraft(e){A(e)||x(8),E(e)&&(e=rt(e));const t=fe(this),r=re(e,void 0);return r[h].isManual_=!0,ee(t),r}finishDraft(e,t){const r=e&&e[h];(!r||!r.isManual_)&&x(9);const{scope_:n}=r;return ge(n,t),pe(void 0,n)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}applyPatches(e,t){let r;for(r=t.length-1;r>=0;r--){const o=t[r];if(o.path.length===0&&o.op==="replace"){e=o.value;break}}r>-1&&(t=t.slice(r+1));const n=z("Patches").applyPatches_;return E(e)?n(e,t):this.produce(e,o=>n(o,t))}};function re(e,t){const r=V(e)?z("MapSet").proxyMap_(e,t):W(e)?z("MapSet").proxySet_(e,t):Ye(e,t);return(t?t.scope_:je()).drafts_.push(r),r}function rt(e){return E(e)||x(10,e),Oe(e)}function Oe(e){if(!A(e)||Z(e))return e;const t=e[h];let r;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,r=Q(e,t.scope_.immer_.useStrictShallowCopy_)}else r=Q(e,!0);return L(r,(n,o)=>{ve(r,n,Oe(o))}),t&&(t.finalized_=!1),r}var y=new tt,nt=y.produce;y.produceWithPatches.bind(y);y.setAutoFreeze.bind(y);y.setUseStrictShallowCopy.bind(y);y.applyPatches.bind(y);y.createDraft.bind(y);y.finishDraft.bind(y);const ot=e=>(t,r,n)=>(n.setState=(o,i,...s)=>{const a=typeof o=="function"?nt(o):o;return t(a,i,...s)},e(n.setState,r,n)),it=ot;/**
 * @license
 * SPDX-License-Identifier: Apache-2.0
*/const O=Ze(it(e=>({didInit:!1,images:null,layout:"sphere",layouts:null,nodePositions:null,highlightNodes:null,isSidebarOpen:!1,targetImage:null,resetCam:!1,cameraCurrentZ:0}))),he=[{id:"Img_bea_01.png",description:"Uma bela vista da categoria 'bea', item número 1. Detalhes incríveis e cores vibrantes."},{id:"Img_bea_02.png",description:"Explorando o item 2 da série 'bea'. Uma composição verdadeiramente inspiradora."},{id:"Img_bea_03.png",description:"A terceira imagem da coleção 'bea', capturando um momento único e especial."},{id:"Img_bea_04.png",description:"Item 'bea' de número 4. A luz e sombra criam uma atmosfera mágica aqui."},{id:"Img_bea_05.png",description:"Descobrindo a beleza no quinto exemplar 'bea'. Uma cena para ser admirada."},{id:"Img_bea_06.png",description:"Sexta representação 'bea'. Texturas ricas e uma perspectiva envolvente."},{id:"Img_bea_07.png",description:"A arte em 'bea', número 7. Cada detalhe conta uma história diferente."},{id:"Img_bea_08.png",description:"Oitava maravilha da série 'bea'. Um convite à contemplação e imaginação."},{id:"Img_bea_09.png",description:"Quase no fim da linha 'bea', imagem 9. Simplesmente espetacular e memorável."},{id:"Img_bea_10.png",description:"Fechando a categoria 'bea' com a décima imagem. Uma obra-prima visual."},{id:"Img_skate_01.png",description:"Radical! A primeira imagem de 'skate'. Manobras e estilo em cada pixel."},{id:"Img_skate_02.png",description:"Item 2 da série 'skate'. A cultura urbana capturada em um instante."},{id:"Img_skate_03.png",description:"A terceira imagem da coleção 'skate', mostrando a energia das ruas."},{id:"Img_skate_04.png",description:"Adrenalina pura no item 'skate' de número 4. Liberdade sobre rodas."},{id:"Img_skate_05.png",description:"O quinto exemplar 'skate'. A arte do equilíbrio e da criatividade."},{id:"Img_skate_06.png",description:"Sexta foto 'skate'. Um olhar sobre a paixão pelo esporte e pela vida."},{id:"Img_skate_07.png",description:"A vibe 'skate' no número 7. Expressão e movimento em harmonia."},{id:"Img_skate_08.png",description:"Oitava imagem da série 'skate'. Superando limites e desafiando a gravidade."},{id:"Img_skate_09.png",description:"Chegando ao fim da sessão 'skate', imagem 9. Atitude e originalidade."},{id:"Img_skate_10.png",description:"Encerrando a categoria 'skate' com a imagem 10. Puro talento e dedicação."},{id:"Img_head_01.png",description:"Foco no detalhe: primeira imagem 'head'. Expressões que falam por si."},{id:"Img_head_02.png",description:"Item 2 da série 'head'. Um retrato da individualidade e estilo."},{id:"Img_head_03.png",description:"A terceira imagem 'head', capturando a essência e a personalidade."},{id:"Img_head_04.png",description:"Olhares e pensamentos no item 'head' de número 4. Profundidade e emoção."},{id:"Img_head_05.png",description:"O quinto exemplar 'head'. A beleza está nos detalhes únicos."},{id:"Img_head_06.png",description:"Sexta foto 'head'. Uma janela para a alma e suas histórias."},{id:"Img_head_07.png",description:"A perspectiva 'head' no número 7. Cada rosto, um universo."},{id:"Img_head_08.png",description:"Oitava imagem da série 'head'. Força, caráter e autenticidade."},{id:"Img_head_09.png",description:"Retrato finalizando a série 'head', imagem 9. Singularidade em destaque."},{id:"Img_head_10.png",description:"Concluindo 'head' com a décima imagem. A história por trás de cada olhar."},{id:"Img_tenis_01.png",description:"Estilo nos pés: imagem 1 de 'tenis'. Design e conforto se encontram."},{id:"Img_tenis_02.png",description:"Item 2 da série 'tenis'. Mais que um calçado, uma declaração."},{id:"Img_tenis_03.png",description:"A terceira imagem 'tenis', mostrando inovação e atitude."},{id:"Img_tenis_04.png",description:"Performance e moda no item 'tenis' número 4. Pronto para qualquer jornada."},{id:"Img_tenis_05.png",description:"O quinto exemplar 'tenis'. Detalhes que fazem toda a diferença."},{id:"Img_tenis_06.png",description:"Sexta foto 'tenis'. A combinação perfeita de funcionalidade e estética."},{id:"Img_tenis_07.png",description:"A tendência 'tenis' no número 7. Conectando você ao seu caminho."},{id:"Img_tenis_08.png",description:"Oitava imagem da série 'tenis'. Durabilidade e um visual impecável."},{id:"Img_tenis_09.png",description:"Quase lá na coleção 'tenis', imagem 9. Para quem não abre mão de estilo."},{id:"Img_tenis_10.png",description:"Fechando 'tenis' com a décima imagem. A escolha certa para seus passos."},{id:"Img_bag_01.png",description:"Acessório essencial: primeira imagem 'bag'. Praticidade e elegância."},{id:"Img_bag_02.png",description:"Item 2 da série 'bag'. Leve tudo o que precisa com muito estilo."},{id:"Img_bag_03.png",description:"A terceira imagem 'bag', design inteligente para o dia a dia."},{id:"Img_bag_04.png",description:"Funcionalidade e charme no item 'bag' número 4. Sua companheira ideal."},{id:"Img_bag_05.png",description:"O quinto exemplar 'bag'. Detalhes que refletem sua personalidade."},{id:"Img_bag_06.png",description:"Sexta foto 'bag'. Organização e um toque de sofisticação."},{id:"Img_bag_07.png",description:"O look completo com 'bag' número 7. Versatilidade para todas as ocasiões."},{id:"Img_bag_08.png",description:"Oitava imagem da série 'bag'. Qualidade e design que impressionam."},{id:"Img_bag_09.png",description:"Finalizando a coleção 'bag', imagem 9. O detalhe que faltava."},{id:"Img_bag_10.png",description:"Concluindo 'bag' com a décima imagem. Perfeita para suas aventuras."},{id:"Img_food_01.png",description:"Delícia à vista: primeira imagem 'food'. Sabores que encantam."},{id:"Img_food_02.png",description:"Item 2 da série 'food'. Uma experiência gastronômica inesquecível."},{id:"Img_food_03.png",description:"A terceira imagem 'food', arte culinária que inspira."},{id:"Img_food_04.png",description:"Ingredientes frescos e paixão no item 'food' número 4. Para todos os paladares."},{id:"Img_food_05.png",description:"O quinto exemplar 'food'. Uma verdadeira festa de cores e sabores."},{id:"Img_food_06.png",description:"Sexta foto 'food'. Tradição e inovação em cada prato."},{id:"Img_food_07.png",description:"O prazer de comer bem com 'food' número 7. Momentos deliciosos."},{id:"Img_food_08.png",description:"Oitava imagem da série 'food'. Da cozinha para sua mesa, com carinho."},{id:"Img_food_09.png",description:"Quase na sobremesa da coleção 'food', imagem 9. Uma tentação irresistível."},{id:"Img_food_10.png",description:"Fechando o cardápio 'food' com a décima imagem. Bom apetite e volte sempre!"}];/**
 * @license
 * SPDX-License-Identifier: Apache-2.0
*/const ne=O.getState,N=O.setState,st=async()=>{if(console.log("[actions.js] init() called"),ne().didInit){console.log("[actions.js] init() already run, returning.");return}N(i=>{i.didInit=!0}),console.log("[actions.js] Fetching layout data...");const[e,t]=await Promise.all(["sphere","umap-grid"].map(i=>fetch(`/picture-site/${i}.json`).then(s=>s.json())));console.log("[actions.js] Layout data fetched:",{sphereLayoutData:e,umapGridLayoutData:t}),console.log("[actions.js] Imported localMeta:",he);const r=he,n=Object.values(e),o=Object.values(t).map(([i,s])=>[i,s/(16/9)+.25]);N(i=>{i.images=r,i.rawLayoutPositions={sphere:n,grid:o},i.nodePositions=Object.fromEntries(r.map(({id:s})=>[s,[.5,.5,.5]])),i.layouts={},console.log("[actions.js] State after setting images and layouts:",JSON.parse(JSON.stringify(i)))}),oe("sphere"),console.log("[actions.js] init() finished")},oe=e=>{console.log(`[actions.js] setLayout called with layout: ${e}`),N(t=>{t.layout=e;const r=t.rawLayoutPositions[e];if(!r){console.error(`Layout positions for "${e}" not found in state.rawLayoutPositions.`),t.nodePositions=Object.fromEntries(t.images.map(({id:o})=>[o,[.5,.5,.5]]));return}const n={};t.images.forEach((o,i)=>{i<r.length?n[o.id]=r[i]:n[o.id]=r[r.length-1]||[.5,.5,.5]}),t.nodePositions=n,console.log(`[actions.js] State after setLayout(${e}):`,JSON.parse(JSON.stringify(t)))})},ae=async e=>{console.log(`[actions.js] setTargetImage called with: ${e}`),e===ne().targetImage&&(console.log("[actions.js] Unsetting targetImage."),e=null),N(t=>{t.targetImage=e,t.highlightNodes=null,e===null&&(t.resetCam=!0,console.log("[actions.js] resetCam set to true."))}),console.log(`[actions.js] targetImage set to: ${ne().targetImage}`)},at=()=>{console.log("[actions.js] toggleSidebar called"),N(e=>{e.isSidebarOpen=!e.isSidebarOpen,console.log(`[actions.js] isSidebarOpen set to: ${e.isSidebarOpen}`)})},ct=e=>{console.log(`[actions.js] setSidebarOpen called with: ${e}`),N(t=>{t.isSidebarOpen=e,console.log(`[actions.js] isSidebarOpen set to: ${t.isSidebarOpen}`)})};st();const dt=1,Ae=16,lt=Ae*dt,ut=({id:e,position:t,targetImage:r})=>{const n=`/picture-site/assets/images/${e}`;console.log(`[PhotoNode.jsx] Loading texture for ID ${e} from URL: ${n}`);const o=m.useRef(),i=m.useRef(),[s,a]=m.useState(null),[f,I]=m.useState(!1),[p,l]=m.useState(!1),S=m.useRef(new P(...t)),v=m.useRef(new P(...t)),j=m.useRef(1),C=m.useRef(0),F=m.useRef(1),R=m.useRef(1);m.useEffect(()=>{new Ee().load(n,u=>{a(u),I(!0),console.log(`[PhotoNode.jsx] Texture loaded for ${e}`)},void 0,u=>{console.error(`[PhotoNode.jsx] Failed to load texture for ${e}:`,u),I(!0)})},[n,e]),m.useEffect(()=>{S.current.set(...t)},[t]);const d=r===e;return m.useEffect(()=>{!r||d?(j.current=1,F.current=d?1.2:1):(j.current=.3,F.current=.8)},[r,d]),be((g,u)=>{if(f&&(i.current&&(v.current.lerp(S.current,u*3),i.current.position.copy(v.current)),o.current&&o.current.material)){C.current=X.lerp(C.current,j.current,u*4),o.current.material.opacity=C.current,R.current=X.lerp(R.current,F.current,u*5);const _=p?1.1:1,b=R.current*_;o.current.scale.setScalar(b)}}),f?c.jsx("group",{ref:i,onClick:g=>{g.stopPropagation(),ae(e),console.log(`[PhotoNode.jsx] Clicked ${e}`)},onPointerEnter:()=>l(!0),onPointerLeave:()=>l(!1),children:c.jsx(Ne,{children:c.jsxs("mesh",{ref:o,scale:[lt,Ae,1],children:[c.jsx("planeGeometry",{}),c.jsx("meshBasicMaterial",{map:s,color:s?"white":"red",transparent:!0,opacity:C.current,side:Fe})]})})}):null};function mt(){console.log("[PhotoViz.jsx] SceneContent rendering");const{images:e,nodePositions:t,layout:r,targetImage:n,resetCam:o}=O(d=>({images:d.images,nodePositions:d.nodePositions,layout:d.layout,targetImage:d.targetImage,resetCam:d.resetCam})),{camera:i}=ke(),s=m.useRef(),a=m.useRef(),[f,I]=m.useState(!1),p=m.useRef(0),l=m.useRef({isAnimating:!1,startTime:0,duration:800,startPosition:new P,targetPosition:new P,startTarget:new P,targetTarget:new P}),S=.1,v=.5,j=25,C=()=>{I(!1),p.current=0,l.current.isAnimating=!1},F=()=>{},R=d=>d<.5?2*d*d:-1+(4-2*d)*d;return m.useEffect(()=>{if(i&&a.current&&s.current){if(n&&t){I(!1),p.current=0;const d=t[n];if(!d){console.warn(`No node position found for targetImage: ${n}`);return}const g=(d[0]-.5)*600,u=(d[1]-.5)*600,_=((d[2]||0)-.5)*600,b=s.current.rotation.y,ze=s.current.position.z,ce=new P(g*Math.cos(b)-_*Math.sin(b),u,g*Math.sin(b)+_*Math.cos(b)+ze),$=i.position.clone().sub(a.current.target);$.lengthSq()===0&&$.set(0,0,1),$.normalize().multiplyScalar(j);const Ce=ce.clone().add($);l.current.isAnimating=!0,l.current.startTime=Date.now(),l.current.startPosition.copy(i.position),l.current.targetPosition.copy(Ce),l.current.startTarget.copy(a.current.target),l.current.targetTarget.copy(ce)}else if(!n){const d=new P(0,0,195),g=new P(0,0,0);l.current.isAnimating=!0,l.current.startTime=Date.now(),l.current.startPosition.copy(i.position),l.current.targetPosition.copy(d),l.current.startTarget.copy(a.current.target),l.current.targetTarget.copy(g)}}},[n,t,i]),m.useEffect(()=>{if(s.current){const d=r==="grid"?150:0,g=s.current.position.z,u=()=>{let _=0;const b=()=>{if(_+=.02,_>=1){s.current.position.z=d;return}s.current.position.z=X.lerp(g,d,R(_)),requestAnimationFrame(b)};b()};Math.abs(g-d)>.1&&u(),o&&(s.current.rotation.set(0,0,0),O.setState(_=>{_.resetCam=!1}))}},[r,o]),be((d,g)=>{if(O.setState({cameraCurrentZ:i.position.z}),l.current.isAnimating&&i&&a.current){const u=Date.now()-l.current.startTime,_=Math.min(u/l.current.duration,1),b=R(_);i.position.lerpVectors(l.current.startPosition,l.current.targetPosition,b),a.current.target.lerpVectors(l.current.startTarget,l.current.targetTarget,b),_>=1&&(l.current.isAnimating=!1,i.position.copy(l.current.targetPosition),a.current.target.copy(l.current.targetTarget))}if(!l.current.isAnimating){let u=p.current;f?u+=(S-u)*v*g:u+=(0-u)*v*g,p.current=u,s.current&&Math.abs(u)>1e-4&&r!=="grid"&&!n&&(s.current.rotation.y+=u*g)}a.current&&a.current.update()}),console.log("[PhotoViz.jsx] SceneContent returning JSX"),c.jsxs(c.Fragment,{children:[c.jsx("ambientLight",{intensity:2.3}),c.jsx($e,{ref:a,onStart:C,onEnd:F,minDistance:20,maxDistance:195,noPan:!0}),c.jsx("group",{ref:s,children:e==null?void 0:e.map(d=>{const g=t==null?void 0:t[d.id];if(!g)return console.warn(`[PhotoViz.jsx] No position found for image ID: ${d.id}`),null;const u=[(g[0]-.5)*600,(g[1]-.5)*600,((g[2]||0)-.5)*600];return c.jsx(ut,{id:d.id,position:u,targetImage:n},d.id)})})]})}function gt(){return console.log("[PhotoViz.jsx] PhotoViz rendering"),c.jsx(Te,{camera:{position:[0,0,195],near:.1,far:1e4},onPointerMissed:()=>ae(null),children:c.jsx(mt,{})})}const K=(e,t=7)=>{if(!e)return"";const r=e.split(" ");return r.length<=t?e:r.slice(0,t).join(" ")+" ..."},ft=()=>{console.log("[Sidebar.jsx] Rendering Sidebar component");const{images:e,targetImage:t,isSidebarOpen:r}=O(s=>({images:s.images,targetImage:s.targetImage,isSidebarOpen:s.isSidebarOpen}));console.log("[Sidebar.jsx] Values from useStore:",{imagesLength:e==null?void 0:e.length,targetImage:t,isSidebarOpen:r});const n=e?e.find(s=>s.id===t):null;console.log("[Sidebar.jsx] selectedImage:",n?n.id:null);const o=e?[...e].sort((s,a)=>s.id.localeCompare(a.id)):[];console.log("[Sidebar.jsx] sortedImages length:",o.length);const i=()=>{ct(!r)};return console.log("[Sidebar.jsx] Returning JSX"),c.jsxs("div",{className:`fixed top-0 right-0 h-full bg-gray-800 bg-opacity-90 text-white p-4 transition-transform duration-300 ease-in-out transform ${r?"translate-x-0":"translate-x-full"} w-80 md:w-96 z-30 shadow-lg`,children:[c.jsx("button",{onClick:i,className:"absolute top-4 right-4 text-white hover:text-gray-300 transition-colors text-2xl z-40 w-8 h-8 flex items-center justify-center",children:"×"}),n&&c.jsxs("div",{className:"mb-6 pt-8",children:[c.jsx("h2",{className:"text-2xl font-bold mb-3",children:"Selected Image"}),c.jsxs("div",{className:"bg-gray-700 p-3 rounded-lg shadow-md",children:[c.jsx("img",{src:`/picture-site/assets/images/${n.id}`,alt:n.description,className:"w-full h-auto object-cover rounded-md mb-2 shadow-sm"}),c.jsx("p",{className:"text-sm text-gray-300 leading-relaxed",children:K(n.description,3)})]})]}),c.jsxs("ul",{children:[o.map(s=>c.jsxs("li",{onClick:()=>ae(s.id),className:`cursor-pointer p-2 hover:bg-gray-700 rounded-md transition-colors duration-150 flex items-center space-x-3 ${t===s.id?"bg-blue-500 bg-opacity-40":""}`,children:[c.jsx("img",{src:`/picture-site/assets/images/${s.id}`,alt:K(s.description,3),className:"w-16 h-16 object-cover rounded-sm shadow-sm"}),c.jsx("div",{children:c.jsx("p",{children:K(s.description,3)})})]},s.id)),(!e||e.length===0)&&c.jsx("li",{children:"No images available."})]})]})};function pt(){var s;console.log("[App.jsx] Rendering App component");const{layout:e,isSidebarOpen:t,images:r,targetImage:n,cameraCurrentZ:o}=O(a=>(console.log("[App.jsx] useStore called, current state:",JSON.parse(JSON.stringify(a))),{layout:a.layout,isSidebarOpen:a.isSidebarOpen,images:a.images,targetImage:a.targetImage,cameraCurrentZ:a.cameraCurrentZ}));console.log("[App.jsx] Values from useStore:",{layout:e,isSidebarOpen:t,imagesLength:r==null?void 0:r.length,targetImage:n,cameraCurrentZ:o}),console.log("Current targetImage:",n);const i=n&&r?(s=r.find(a=>a.id===n))==null?void 0:s.description:null;return console.log("Current selectedImageDescription:",i),console.log("[App.jsx] Returning JSX"),c.jsxs("main",{children:[c.jsx(gt,{}),c.jsx(ft,{}),i&&c.jsx("div",{className:q("description-panel",{visible:!!i}),children:c.jsx("p",{children:i})}),c.jsxs("div",{className:"fixed bottom-4 left-4 flex gap-2 z-20",children:[c.jsx("button",{onClick:()=>oe("sphere"),className:q("px-4 py-2 rounded-lg text-sm font-medium transition-all duration-200",e==="sphere"?"bg-blue-500 text-white shadow-lg":"bg-gray-800 bg-opacity-80 text-gray-300 hover:bg-gray-700"),children:"Sphere"}),c.jsx("button",{onClick:()=>oe("grid"),className:q("px-4 py-2 rounded-lg text-sm font-medium transition-all duration-200",e==="grid"?"bg-blue-500 text-white shadow-lg":"bg-gray-800 bg-opacity-80 text-gray-300 hover:bg-gray-700"),children:"Grid"})]}),c.jsx("button",{onClick:at,className:q("sidebarButton iconButton",{active:t}),"aria-label":"Toggle photo list",title:"Toggle photo list",children:c.jsx("span",{className:"icon",children:"list"})}),c.jsxs("div",{style:{position:"fixed",bottom:"10px",right:"10px",backgroundColor:"rgba(0,0,0,0.5)",color:"white",padding:"5px 10px",borderRadius:"3px",fontSize:"12px",zIndex:1e4},children:["Camera Z: ",o.toFixed(2)," | Layout: ",e]})]})}/**
 * @license
 * SPDX-License-Identifier: Apache-2.0
*/console.log("[main.tsx] Script start");console.log("[main.tsx] Rendering React app");const ye=document.getElementById("root");ye?qe.createRoot(ye).render(c.jsx(pt,{})):console.error("[main.tsx] Root element not found");
//# sourceMappingURL=index-DxRwDsIN.js.map
